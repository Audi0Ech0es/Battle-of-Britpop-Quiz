<div id="britpop-quiz" class="bpq" aria-live="polite">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&family=Merriweather:wght@300;400;700&display=swap');

    #britpop-quiz {
      all: initial;
      isolation: isolate;
      display: block;
      position: relative;
      padding: 48px 24px;
      background: rgba(255,255,255,0.95);
      border-radius: 16px;
      max-width: 1120px;
      margin: 0 auto;
      font-family: 'Merriweather', Georgia, serif;
      color: #000;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    #britpop-quiz *, #britpop-quiz *::before, #britpop-quiz *::after {
      all: unset;
      box-sizing: border-box;
      font-family: inherit;
      color: inherit;
    }

    .bpq .screen { padding: 0; }
    .bpq .bpq-container {
      width: 100%;
      padding: 0 20px;
      margin: 0 auto;
      max-width: 1120px;
    }

    .bpq h1, .bpq h2 {
      font-family: 'Comfortaa', sans-serif;
      font-weight: 400;
      margin: 0;
    }

    .bpq h1 {
      font-size: clamp(1.8rem, 1.2rem + 1.8vw, 2.5rem);
      line-height: 1.2;
    }

    .lead {
      color: #4b5563;
      font-size: 1rem;
      margin-top: 12px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 16px;
      background: black;
      color: white;
      border-radius: 999px;
      font-weight: 600;
      font-size: 0.95rem;
      margin-top: 20px;
      cursor: pointer;
    }

    .btn.secondary {
      background: transparent;
      color: black;
      border: 1px solid #e5e5e5;
    }

    .progress {
      height: 3px;
      background: #eee;
      border-radius: 999px;
      overflow: hidden;
      margin-top: 16px;
    }

    .bar {
      height: 100%;
      width: 0%;
      background: #000;
      transition: width 0.3s ease;
    }

    .answers {
      display: grid;
      gap: 14px;
      margin-top: 16px;
    }

    .opt {
      display: flex;
      align-items: center;
      gap: 12px;
      background: white;
      border: 1px solid #e5e5e5;
      padding: 12px 14px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 600;
    }

    .opt:hover {
      background: #f9f9f9;
      border-color: #dcdcdc;
    }

    .opt[aria-disabled="true"] {
      opacity: 0.6;
      pointer-events: none;
    }

    .badge {
      display: inline-grid;
      place-items: center;
      width: 24px;
      height: 24px;
      font-size: 0.8rem;
      font-weight: bold;
      border: 2px solid #cbd5e1;
      border-radius: 50%;
      color: #475569;
      flex-shrink: 0;
    }

    .opt.correct {
      background: #fff;
      border-color: #000;
      color: #000;
    }

    .opt.incorrect {
      background: #fff;
      border-color: #000;
      border-style: dashed;
      color: #000;
    }

    .opt.dim {
      color: #94a3b8;
    }

    .badge.correct {
      background: #000;
      color: #fff;
      border-color: #000;
    }

    .badge.incorrect {
      background: transparent;
      color: #000;
      border-color: #000;
    }

    .q {
      font-size: clamp(1.1rem, 1vw + 1rem, 1.4rem);
      margin-top: 20px;
    }

    .feedback {
      margin-top: 16px;
      padding: 10px 14px;
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      background: #f9f9f9;
      font-style: italic;
      display: none;
    }

    .feedback.show {
      display: block;
    }

    .row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 20px;
    }

    @media (max-width: 768px) {
      #britpop-quiz {
        padding: 32px 16px;
      }
      .bpq .bpq-container {
        padding: 0 12px;
      }
    }
  </style>

  <!-- Quiz Screens -->
  <section class="screen" data-screen="start">
    <div class="bpq-container fade">
      <h1 class="fade">Battle of <strong>Britpop</strong></h1>
      <p class="lead">Test your knowledge of the legendary 1995 chart battle between Blur and Oasis that defined a generation.</p>
      <div class="lead">10 questions • ~5 minutes</div>
      <button class="btn" data-action="start">Start Quiz</button>
    </div>
  </section>

  <section class="screen" data-screen="question" hidden>
    <div class="bpq-container">
      <div class="row">
        <div class="lead"><strong>Question <span data-ref="current-q">1</span></strong> of <span data-ref="total-q">10</span></div>
        <div class="lead"><span data-ref="score">0</span>/<span data-ref="total-q">10</span> correct</div>
      </div>
      <div class="progress"><div class="bar" data-ref="bar" style="width:10%"></div></div>
      <div class="qwrap">
        <h2 class="q" data-ref="question"></h2>
        <div class="answers" data-ref="answers" role="group" aria-label="Answer choices"></div>
        <div class="feedback" data-ref="feedback" role="status" aria-live="polite"></div>
        <button class="btn" data-action="next" hidden>Continue</button>
      </div>
    </div>
  </section>

  <section class="screen" data-screen="results" hidden>
    <div class="bpq-container fade">
      <h1>Quiz <strong>Complete</strong></h1>
      <div style="font-size:2rem; font-weight:300;">
        <span data-ref="final">0</span><span class="lead">/<span data-ref="total-q">10</span></span>
      </div>
      <p class="lead" data-ref="message"></p>
      <div class="row" style="flex-wrap:wrap; gap:8px;">
        <button class="btn" data-action="restart">Try Again</button>
        <button class="btn secondary" data-action="tweet">Tweet Results</button>
      </div>
    </div>
  </section>

  <script>
    (function(){
      const data = [
        { q:"Which two bands clashed in the UK singles chart on 14 August 1995?", a:["Blur and Oasis","Pulp and Suede","Radiohead and The Verve"], c:0 },
        { q:"What were the titles of the two singles released head to head that day?", a:["Country House and Roll With It","Parklife and Wonderwall","Girls & Boys and Some Might Say"], c:0 },
        { q:"Which single claimed the Number 1 spot, and by what margin of sales?", a:["Oasis – Roll With It, by 30,000 copies","Blur – Country House, by 58,000 copies","Take That – Never Forget, by 10,000 copies"], c:1 },
        { q:"Who directed the music video for Blur's Country House?", a:["Damien Hirst","Guy Ritchie","Sophie Muller"], c:0 },
        { q:"Where was the sleeve photo for Oasis's Roll With It taken?", a:["Blackpool Pier","Weston-super-Mare","Brighton Beach"], c:1 },
        { q:"Which Blur band member wore an Oasis T-shirt on Top of the Pops to mark their victory?", a:["Damon Albarn","Alex James","Graham Coxon"], c:1 },
        { q:"What pricing strategy gave Blur an advantage in the chart race?", a:["Selling CD singles for £1.99 in major chains","Giving away free copies with NME","Including posters inside every cassette"], c:0 },
        { q:"Which B-side on the Roll With It single is now considered one of Noel Gallagher's finest songs?", a:["Rockin' Chair","Talk Tonight","Acquiesce"], c:1 },
        { q:"Which presenter introduced Blur's performance of Country House on Top of the Pops?", a:["Chris Evans","Jarvis Cocker","Jo Whiley"], c:1 },
        { q:"What album did Oasis release just weeks later that went on to define mid-90s rock worldwide?", a:["(What's the Story) Morning Glory?","Be Here Now","Definitely Maybe"], c:0 }
      ];

      const root = document.getElementById('britpop-quiz');
      const $ = s => root.querySelector(s);
      const $$ = s => Array.from(root.querySelectorAll(s));
      const screens = {
        start: $('[data-screen="start"]'),
        question: $('[data-screen="question"]'),
        results: $('[data-screen="results"]')
      };
      const refs = {
        currentQ: $('[data-ref="current-q"]'),
        score: $('[data-ref="score"]'),
        bar: $('[data-ref="bar"]'),
        qText: $('[data-ref="question"]'),
        answers: $('[data-ref="answers"]'),
        feedback: $('[data-ref="feedback"]'),
        nextBtn: $('[data-action="next"]'),
        final: $('[data-ref="final"]'),
        message: $('[data-ref="message"]')
      };

      $$('[data-ref="total-q"]').forEach(el => el.textContent = String(data.length));
      let idx = 0, score = 0, picked = null;

      function show(which) {
        Object.values(screens).forEach(s => s.hidden = true);
        screens[which].hidden = false;
      }

      function start() {
        idx = 0;
        score = 0;
        picked = null;
        refs.score.textContent = '0';
        show('question');
        render();
      }

      function render() {
        const q = data[idx];
        refs.currentQ.textContent = String(idx + 1);
        refs.bar.style.width = `${((idx + 1) / data.length) * 100}%`;
        refs.qText.textContent = q.q;
        refs.feedback.className = 'feedback';
        refs.feedback.textContent = '';
        refs.nextBtn.hidden = true;
        refs.nextBtn.disabled = true;

        refs.answers.innerHTML = '';
        q.a.forEach((label, i) => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'opt';
          btn.dataset.index = String(i);
          btn.setAttribute('aria-disabled', 'false');
          const badge = document.createElement('span');
          badge.className = 'badge';
          badge.textContent = String.fromCharCode(65 + i);
          const span = document.createElement('span');
          span.textContent = label;
          btn.appendChild(badge);
          btn.appendChild(span);
          refs.answers.appendChild(btn);
        });
      }

      function lockAnswers(correctIdx, chosenIdx) {
        $$('.opt').forEach((el, i) => {
          const badge = el.querySelector('.badge');
          if (i === correctIdx) {
            el.classList.add('correct');
            badge.classList.add('correct');
          } else if (i === chosenIdx) {
            el.classList.add('incorrect');
            badge.classList.add('incorrect');
          } else {
            el.classList.add('dim');
          }
          el.setAttribute('aria-disabled', 'true');
        });
      }

      function onPick(i) {
        if (picked !== null) return;
        picked = i;
        const correct = data[idx].c;
        if (i === correct) {
          score++;
          refs.score.textContent = String(score);
          refs.feedback.className = 'feedback show';
          refs.feedback.textContent = '✓ Correct';
        } else {
          refs.feedback.className = 'feedback show';
          refs.feedback.textContent = `✕ Incorrect. Correct: ${data[idx].a[correct]}`;
        }
        lockAnswers(correct, i);
        refs.nextBtn.textContent = (idx === data.length - 1) ? 'View Results' : 'Continue';
        refs.nextBtn.hidden = false;
        refs.nextBtn.disabled = false;
        refs.nextBtn.focus();
      }

      function next() {
        if (picked === null) return;
        if (idx < data.length - 1) {
          idx++;
          picked = null;
          render();
        } else {
          show('results');
          refs.final.textContent = String(score);
          const pct = Math.round((score / data.length) * 100);
          refs.message.textContent =
            pct >= 90 ? "Outstanding! You're a true Britpop expert." :
            pct >= 70 ? "Excellent work! You know your 90s music history." :
            pct >= 50 ? "Good effort! Time to dive deeper into Britpop." :
            "Keep exploring this amazing era of British music.";
        }
      }

      function restart() {
        show('start');
      }

      function tweet() {
        const pct = Math.round((score / data.length) * 100);
        const text = `I scored ${score}/${data.length} (${pct}%) on the Battle of Britpop Quiz!`;
        const url = 'https://audi0ech0es.github.io/Battle-of-Britpop-Quiz/';
        const intent = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(text) + '&url=' + encodeURIComponent(url);
        window.open(intent, '_blank');
      }

      root.addEventListener('click', e => {
        const t = e.target;
        const ans = t.closest('.opt');
        if (ans && ans.getAttribute('aria-disabled') !== 'true') {
          onPick(Number(ans.dataset.index));
          return;
        }
        const action = t.closest('[data-action]');
        if (!action) return;
        const act = action.getAttribute('data-action');
        if (act === 'start') start();
        else if (act === 'next') next();
        else if (act === 'restart') restart();
        else if (act === 'tweet') tweet();
      });

      show('start');
    })();
  </script>
</div>
